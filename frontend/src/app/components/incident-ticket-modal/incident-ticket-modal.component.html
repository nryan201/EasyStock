<div class="modal-backdrop" *ngIf="visible" (click)="onBackdropClick($event)">
  <div class="modal" (click)="$event.stopPropagation()">
    <!-- Bouton de fermeture -->
    <button class="close-button" (click)="onCancel()" aria-label="Fermer">
      Ã—
    </button>

    <!-- IcÃ´ne du ticket -->
    <div class="modal-icon">
      ðŸŽ«
    </div>

    <h2 class="modal-title">Ticket d'incident</h2>
    <p class="modal-subtitle">Signalez un problÃ¨me technique pour obtenir de l'aide</p>

    <div class="modal-content">
      <form (ngSubmit)="onSubmit()" class="ticket-form">

        <!-- Email de l'expÃ©diteur -->
        <div class="form-group">
          <label class="form-label" for="sender-email">
            Email de l'expÃ©diteur <span class="required">*</span>
          </label>
          <div class="input-container">
            <input
              #emailInput
              id="sender-email"
              type="email"
              class="form-input"
              [(ngModel)]="senderEmail"
              name="senderEmail"
              required
              placeholder="votre.email@exemple.com"
            />
            <span class="input-icon">ðŸ“§</span>
          </div>
        </div>

        <!-- Type de problÃ¨me -->
        <div class="form-group">
          <label class="form-label" for="problem-type">
            Type de problÃ¨me <span class="required">*</span>
          </label>
          <div class="select-container">
            <select
              id="problem-type"
              class="form-select"
              [(ngModel)]="problemType"
              name="problemType"
              required
            >
              <option value="" disabled>Choisir un type de problÃ¨me</option>
              <option *ngFor="let problem of problemTypes" [value]="problem">
                {{ problem }}
              </option>
            </select>
            <span class="select-arrow">â–¼</span>
          </div>
        </div>

        <!-- PrioritÃ© -->


        <!-- Message -->
        <div class="form-group">
          <label class="form-label" for="message">
            Description du problÃ¨me <span class="required">*</span>
          </label>
          <textarea
            id="message"
            class="form-textarea"
            [(ngModel)]="message"
            name="message"
            rows="5"
            placeholder="DÃ©crivez le problÃ¨me en dÃ©tail : que s'est-il passÃ© ? Ã€ quel moment ? Quelles Ã©tapes avez-vous suivies ?"
            required
          ></textarea>
          <div class="character-count">
            {{ message.length }}/500 caractÃ¨res
          </div>
        </div>

      </form>
    </div>

    <!-- Actions -->
    <div class="modal-actions">
      <button type="button" class="btn btn-secondary" (click)="onCancel()">
        Annuler
      </button>
      <button
        type="button"
        class="btn btn-primary"
        (click)="onSubmit()"
        [disabled]="!isFormValid() || isSubmitting"
      >
        <span *ngIf="isSubmitting" class="spinner"></span>
        <span *ngIf="!isSubmitting">ðŸ“¤ Envoyer le ticket</span>
      </button>
    </div>
  </div>
</div>
